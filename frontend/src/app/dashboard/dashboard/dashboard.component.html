<div class="admin-dashboard container-fluid">
    <div class="row">
      <!-- Sidebar -->
      <div class="col-md-2 sidebar">
        <div class="logo mb-4">
          <h2>Admin Panel</h2>
        </div>
        <div class="nav flex-column">
          <button 
            class="nav-link" 
            [class.active]="activeTab === 'users'"
            (click)="switchTab('users')"
          >
            <i class="fas fa-users"></i> Users
          </button>
          <button 
            class="nav-link" 
            [class.active]="activeTab === 'roles'"
            (click)="switchTab('roles')"
          >
            <i class="fas fa-user-tag"></i> Roles
          </button>
          <button 
            class="nav-link" 
            [class.active]="activeTab === 'categories'"
            (click)="switchTab('categories')"
          >
            <i class="fas fa-layer-group"></i> Categories
          </button>
        </div>
      </div>
  
      <!-- Main Content -->
      <div class="col-md-10 main-content">
        <!-- Users Table -->
        <div *ngIf="activeTab === 'users'" class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h3>Users Management</h3>
            <button class="btn btn-primary" (click)="openModal('add')">
              <i class="fas fa-plus"></i> Add User
            </button>
          </div>
          <div class="card-body">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Email</th>
                  <th>Roles</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let user of users">
                  <td>{{ user.email }}</td>
                  <td>{{ getUserRoles(user) }}</td>
                  <td>
                    <span 
                      class="badge" 
                      [class.bg-success]="user.is_active" 
                      [class.bg-danger]="!user.is_active"
                    >
                      {{ user.is_active ? 'Active' : 'Inactive' }}
                    </span>
                  </td>
                  <td>
                    <div class="btn-group">
                      <button 
                        class="btn btn-sm btn-warning" 
                        (click)="openModal('edit', user)"
                      >
                        <i class="fas fa-edit"></i>
                      </button>
                      <button 
                        class="btn btn-sm btn-danger" 
                        (click)="deleteEntity('users', user._id)"
                      >
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
  
        <!-- Roles Table -->
        <div *ngIf="activeTab === 'roles'" class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h3>Roles Management</h3>
            <button class="btn btn-primary" (click)="openModal('add')">
              <i class="fas fa-plus"></i> Add Role
            </button>
          </div>
          <div class="card-body">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Role Name</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let role of roles">
                  <td>{{ role.role_name }}</td>
                  <td>
                    <span 
                      class="badge" 
                      [class.bg-success]="role.is_active" 
                      [class.bg-danger]="!role.is_active"
                    >
                      {{ role.is_active ? 'Active' : 'Inactive' }}
                    </span>
                  </td>
                  <td>
                    <div class="btn-group">
                      <button 
                        class="btn btn-sm btn-warning" 
                        (click)="openModal('edit', role)"
                      >
                        <i class="fas fa-edit"></i>
                      </button>
                      <button 
                        class="btn btn-sm btn-danger" 
                        (click)="deleteEntity('roles', role._id)"
                      >
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
  
        <!-- Categories Table -->
        <div *ngIf="activeTab === 'categories'" class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h3>Categories Management</h3>
            <button class="btn btn-primary" (click)="openModal('add')">
              <i class="fas fa-plus"></i> Add Category
            </button>
          </div>
          <div class="card-body">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Category Name</th>
                  <th>Description</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let category of categories">
                  <td>{{ category.name }}</td>
                  <td>{{ category.description || 'No description' }}</td>
                  <td>
                    <span 
                      class="badge" 
                      [class.bg-success]="category.is_active" 
                      [class.bg-danger]="!category.is_active"
                    >
                      {{ category.is_active ? 'Active' : 'Inactive' }}
                    </span>
                  </td>
                  <td>
                    <div class="btn-group">
                      <button 
                        class="btn btn-sm btn-warning" 
                        (click)="openModal('edit', category)"
                      >
                        <i class="fas fa-edit"></i>
                      </button>
                      <button 
                        class="btn btn-sm btn-danger" 
                        (click)="deleteEntity('categories', category._id)"
                      >
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
  
        <!-- Modal -->
        <div class="modal" [class.show]="isModalOpen" *ngIf="isModalOpen">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">
                  {{ modalMode === 'add' ? 'Add' : 'Edit' }} 
                  {{ activeTab === 'users' ? 'User' : (activeTab === 'roles' ? 'Role' : 'Category') }}
                </h5>
                <button type="button" class="btn-close" (click)="closeModal()"></button>
              </div>
              <div class="modal-body">
                <!-- Dynamic Form Based on Active Tab -->
                <form (ngSubmit)="saveEntity()">
                  <!-- Users Form -->
                  <div *ngIf="activeTab === 'users'">
                    <div class="mb-3">
                      <label class="form-label">Email</label>
                      <input 
                        type="email" 
                        class="form-control" 
                        [(ngModel)]="currentEntity.email" 
                        name="email" 
                        required
                      >
                    </div>
                    <!-- Add more user-specific fields as needed -->
                  </div>
  
                  <!-- Roles Form -->
                  <div *ngIf="activeTab === 'roles'">
                    <div class="mb-3">
                      <label class="form-label">Role Name</label>
                      <input 
                        type="text" 
                        class="form-control" 
                        [(ngModel)]="currentEntity.role_name" 
                        name="role_name" 
                        required
                      >
                    </div>
                    <div class="mb-3 form-check">
                      <input 
                        type="checkbox" 
                        class="form-check-input" 
                        [(ngModel)]="currentEntity.is_active" 
                        name="is_active"
                      >
                      <label class="form-check-label">Active</label>
                    </div>
                  </div>
  
                  <!-- Categories Form -->
                  <div *ngIf="activeTab === 'categories'">
                    <div class="mb-3">
                      <label class="form-label">Category Name</label>
                      <input 
                        type="text" 
                        class="form-control" 
                        [(ngModel)]="currentEntity.name" 
                        name="name" 
                        required
                      >
                    </div>
                    <div class="mb-3">
                      <label class="form-label">Description</label>
                      <textarea 
                        class="form-control" 
                        [(ngModel)]="currentEntity.description" 
                        name="description"
                      ></textarea>
                    </div>
                    <div class="mb-3 form-check">
                      <input 
                        type="checkbox" 
                        class="form-check-input" 
                        [(ngModel)]="currentEntity.is_active" 
                        name="is_active"
                      >
                      <label class="form-check-label">Active</label>
                    </div>
                  </div>
  
                  <button type="submit" class="btn btn-primary">Save</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>